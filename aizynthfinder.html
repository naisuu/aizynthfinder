
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>aizynthfinder package &#8212; aizynthfinder 2.4.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="aizynthfinder.context package" href="aizynthfinder.context.html" />
    <link rel="prev" title="Training" href="training.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">aizynthfinder</a></h1>



<p class="blurb">A fast, robust and flexible software for retrosynthetic planning</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gui.html">Graphical user interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_interface.html">Python interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="stocks.html">Stocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="scoring.html">Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">aizynthfinder package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.context.html">aizynthfinder.context package</a></li>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.interfaces.html">aizynthfinder.interfaces package</a></li>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.mcts.html">aizynthfinder.mcts package</a></li>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.tools.html">aizynthfinder.tools package</a></li>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.training.html">aizynthfinder.training package</a></li>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.utils.html">aizynthfinder.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aizynthfinder.aizynthfinder">aizynthfinder.aizynthfinder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aizynthfinder.analysis">aizynthfinder.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aizynthfinder.chem">aizynthfinder.chem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aizynthfinder">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sequences.html">Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="relationships.html">Relationships</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="training.html" title="previous chapter">Training</a></li>
      <li>Next: <a href="aizynthfinder.context.html" title="next chapter">aizynthfinder.context package</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="aizynthfinder-package">
<h1>aizynthfinder package<a class="headerlink" href="#aizynthfinder-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.context.html">aizynthfinder.context package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.collection">aizynthfinder.context.collection module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.config">aizynthfinder.context.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.policy">aizynthfinder.context.policy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.scoring">aizynthfinder.context.scoring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.stock">aizynthfinder.context.stock module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.interfaces.html">aizynthfinder.interfaces package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.interfaces.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.interfaces.gui.html">aizynthfinder.interfaces.gui package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.interfaces.gui.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.interfaces.gui.html#module-aizynthfinder.interfaces.gui.clustering">aizynthfinder.interfaces.gui.clustering module</a></li>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.interfaces.gui.html#module-aizynthfinder.interfaces.gui">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.interfaces.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.interfaces.html#module-aizynthfinder.interfaces.aizynthapp">aizynthfinder.interfaces.aizynthapp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.interfaces.html#module-aizynthfinder.interfaces.aizynthcli">aizynthfinder.interfaces.aizynthcli module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.interfaces.html#module-aizynthfinder.interfaces">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.mcts.html">aizynthfinder.mcts package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.mcts.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.mcts.html#module-aizynthfinder.mcts.mcts">aizynthfinder.mcts.mcts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.mcts.html#module-aizynthfinder.mcts.node">aizynthfinder.mcts.node module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.mcts.html#module-aizynthfinder.mcts.state">aizynthfinder.mcts.state module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.mcts.html#module-aizynthfinder.mcts">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.tools.html">aizynthfinder.tools package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.tools.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.tools.html#module-aizynthfinder.tools.cat_output">aizynthfinder.tools.cat_output module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.tools.html#module-aizynthfinder.tools.download_public_data">aizynthfinder.tools.download_public_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.tools.html#module-aizynthfinder.tools.make_stock">aizynthfinder.tools.make_stock module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.tools.html#module-aizynthfinder.tools">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.training.html">aizynthfinder.training package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.keras_models">aizynthfinder.training.keras_models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.make_false_products">aizynthfinder.training.make_false_products module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.preprocess_expansion">aizynthfinder.training.preprocess_expansion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.preprocess_filter">aizynthfinder.training.preprocess_filter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.preprocess_recommender">aizynthfinder.training.preprocess_recommender module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.training">aizynthfinder.training.training module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training.utils">aizynthfinder.training.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.training.html#module-aizynthfinder.training">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aizynthfinder.utils.html">aizynthfinder.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="aizynthfinder.utils.route_clustering.html">aizynthfinder.utils.route_clustering package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.utils.route_clustering.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.utils.route_clustering.html#module-aizynthfinder.utils.route_clustering.clustering">aizynthfinder.utils.route_clustering.clustering module</a></li>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.utils.route_clustering.html#module-aizynthfinder.utils.route_clustering.distances">aizynthfinder.utils.route_clustering.distances module</a></li>
<li class="toctree-l4"><a class="reference internal" href="aizynthfinder.utils.route_clustering.html#module-aizynthfinder.utils.route_clustering">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.analysis_helpers">aizynthfinder.utils.analysis_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.files">aizynthfinder.utils.files module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.image">aizynthfinder.utils.image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.logging">aizynthfinder.utils.logging module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.models">aizynthfinder.utils.models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.mongo">aizynthfinder.utils.mongo module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.paths">aizynthfinder.utils.paths module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.serialization">aizynthfinder.utils.serialization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils.type_utils">aizynthfinder.utils.type_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aizynthfinder.utils.html#module-aizynthfinder.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-aizynthfinder.aizynthfinder">
<span id="aizynthfinder-aizynthfinder-module"></span><h2>aizynthfinder.aizynthfinder module<a class="headerlink" href="#module-aizynthfinder.aizynthfinder" title="Permalink to this headline">¶</a></h2>
<p>Module containing a class that is the main interface the retrosynthesis tool.</p>
<dl class="py class">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.aizynthfinder.</span></code><code class="sig-name descname"><span class="pre">AiZynthFinder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Public API to the aizynthfinder tool</p>
<p>If instantiated with the path to a yaml file or dictionary of settings
the stocks and policy networks are loaded directly.
Otherwise, the user is responsible for loading them prior to
executing the tree search.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="aizynthfinder.context.html#module-aizynthfinder.context.config" title="aizynthfinder.context.config"><strong>config</strong></a> – the configuration of the search</p></li>
<li><p><a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.config.Configuration.expansion_policy" title="aizynthfinder.context.config.Configuration.expansion_policy"><strong>expansion_policy</strong></a> – the expansion policy model</p></li>
<li><p><a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.config.Configuration.filter_policy" title="aizynthfinder.context.config.Configuration.filter_policy"><strong>filter_policy</strong></a> – the filter policy model</p></li>
<li><p><a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.config.Configuration.stock" title="aizynthfinder.context.config.Configuration.stock"><strong>stock</strong></a> – the stock</p></li>
<li><p><a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.config.Configuration.scorers" title="aizynthfinder.context.config.Configuration.scorers"><strong>scorers</strong></a> – the loaded scores</p></li>
<li><p><strong>tree</strong> – the search tree</p></li>
<li><p><a class="reference internal" href="#module-aizynthfinder.analysis" title="aizynthfinder.analysis"><strong>analysis</strong></a> – the tree analysis</p></li>
<li><p><strong>routes</strong> – the top-ranked routes</p></li>
<li><p><strong>search_stats</strong> – statistics of the latest search</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>configfile</strong> – the path to yaml file with configuration (has priority over configdict), defaults to None</p></li>
<li><p><strong>configdict</strong> – the config as a dictionary source, defaults to None</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.target_smiles">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">target_smiles</span></code><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.target_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The SMILES representation of the molecule to predict routes on.</p>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.target_mol">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">target_mol</span></code><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.target_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>The molecule to predict routes on</p>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.build_routes">
<code class="sig-name descname"><span class="pre">build_routes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'state</span> <span class="pre">score'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.build_routes" title="Permalink to this definition">¶</a></dt>
<dd><p>Build reaction routes</p>
<p>This is necessary to call after the tree search has completed in order
to extract results from the tree search.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_nodes</strong> (<em>int</em>) – the minimum number of top-ranked nodes to consider, defaults to 5</p></li>
<li><p><strong>scorer</strong> (<em>str</em>) – a reference to the object used to score the nodes</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the search tree not initialized</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.extract_statistics">
<code class="sig-name descname"><span class="pre">extract_statistics</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.extract_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts tree statistics as a dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>StrDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.prepare_tree">
<code class="sig-name descname"><span class="pre">prepare_tree</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.prepare_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the tree for searching</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if the target molecule was not set</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.run_from_json">
<code class="sig-name descname"><span class="pre">run_from_json</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.run_from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a search tree by reading settings from a JSON</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>StrDict</em>) – the parameters of the tree search</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with all settings and top scored routes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>StrDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.aizynthfinder.AiZynthFinder.tree_search">
<code class="sig-name descname"><span class="pre">tree_search</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.aizynthfinder.AiZynthFinder.tree_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the actual tree search</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>show_progress</strong> (<em>bool</em>) – if True, shows a progress bar</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the time past in seconds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aizynthfinder.analysis">
<span id="aizynthfinder-analysis-module"></span><h2>aizynthfinder.analysis module<a class="headerlink" href="#module-aizynthfinder.analysis" title="Permalink to this headline">¶</a></h2>
<p>Module containing classes to perform analysis of the tree search results.</p>
<dl class="py class">
<dt id="aizynthfinder.analysis.TreeAnalysis">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.analysis.</span></code><code class="sig-name descname"><span class="pre">TreeAnalysis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.TreeAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that encapsulate various analysis that can be
performed on a search tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scorer</strong> – the object used to score the nodes</p></li>
<li><p><strong>search_tree</strong> – the search tree</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>search_tree</strong> – the search tree to do the analysis on</p></li>
<li><p><strong>scorer</strong> – the object used to score the nodes, defaults to StateScorer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.analysis.TreeAnalysis.best_node">
<code class="sig-name descname"><span class="pre">best_node</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.TreeAnalysis.best_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the node with the highest score.
If several nodes have the same score, it will return the first</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the top scoring node</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="aizynthfinder.mcts.html#aizynthfinder.mcts.node.Node" title="aizynthfinder.mcts.node.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.TreeAnalysis.sort_nodes">
<code class="sig-name descname"><span class="pre">sort_nodes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.TreeAnalysis.sort_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort and select the nodes, so that the best scoring routes are returned.
The algorithm filter away identical routes and returns at minimum the number specified.
If multiple alternative routes have the same score as the n’th route, they will be included and returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_return</strong> (<em>int</em>) – the minimum number of routes to return, defaults to 5</p></li>
<li><p><strong>max_return</strong> (<em>int</em>) – the maximum number of routes to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the nodes</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the score</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[Sequence[<a class="reference internal" href="aizynthfinder.mcts.html#aizynthfinder.mcts.node.Node" title="aizynthfinder.mcts.node.Node">Node</a>], Sequence[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.TreeAnalysis.tree_statistics">
<code class="sig-name descname"><span class="pre">tree_statistics</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.TreeAnalysis.tree_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns statistics of the tree</p>
<p>Currently it returns the number of nodes, the maximum number of transforms,
maximum number of children, top score, if the top score route is solved,
the number of molecule in the top score node, and information on pre-cursors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the statistics</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>StrDict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.analysis.ReactionTree">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.analysis.</span></code><code class="sig-name descname"><span class="pre">ReactionTree</span></code><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Encapsulation of a bipartite reaction tree of a single route.
The nodes consists of either FixedRetroReaction or UniqueMolecule objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_repeating_patterns</strong> – if the graph has repetitive elements</p></li>
<li><p><a class="reference internal" href="aizynthfinder.mcts.html#aizynthfinder.mcts.mcts.SearchTree.graph" title="aizynthfinder.mcts.mcts.SearchTree.graph"><strong>graph</strong></a> – the bipartite graph</p></li>
<li><p><strong>is_solved</strong> – if all of the leaf nodes are in stock</p></li>
<li><p><strong>root</strong> – the root of the tree</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.from_analysis">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_analysis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.from_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a reaction from a tree analysis.</p>
<p>The single route can be from a given node in the search tree if the <cite>from_node</cite>
argument is given. If it is not given, the top scoring node is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis</strong> (<a class="reference internal" href="#aizynthfinder.analysis.TreeAnalysis" title="aizynthfinder.analysis.TreeAnalysis"><em>TreeAnalysis</em></a>) – the analysis to base the reaction tree on</p></li>
<li><p><strong>from_node</strong> (<a class="reference internal" href="aizynthfinder.mcts.html#aizynthfinder.mcts.node.Node" title="aizynthfinder.mcts.node.Node"><em>Node</em></a>) – the end node of the route, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the reaction tree</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.analysis.ReactionTree" title="aizynthfinder.analysis.ReactionTree">ReactionTree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.from_dict">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new ReactionTree by parsing a dictionary.</p>
<p>This is supposed to be the opposite of <code class="docutils literal notranslate"><span class="pre">to_dict</span></code>,
but because that format loses information, the returned
object is not a full copy:
* The stock will only contain the list of molecules marked as <code class="docutils literal notranslate"><span class="pre">in_stock</span></code> in the dictionary.
* The reaction nodes will be of type <cite>FixedRetroReaction</cite></p>
<p>The returned object should be sufficient to e.g. generate an image of the route.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tree_dict</strong> (<em>StrDict</em>) – the dictionary representation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the reaction tree</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.analysis.ReactionTree" title="aizynthfinder.analysis.ReactionTree">ReactionTree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.depth">
<code class="sig-name descname"><span class="pre">depth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the depth of a node in the route</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule"><em>UniqueMolecule</em></a><em>, </em><a class="reference internal" href="#aizynthfinder.chem.FixedRetroReaction" title="aizynthfinder.chem.FixedRetroReaction"><em>FixedRetroReaction</em></a><em>]</em>) – the query node</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the depth</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.distance_to">
<code class="sig-name descname"><span class="pre">distance_to</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.distance_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the distance to another reaction tree</p>
<p>This is a tree edit distance, with unit cost to
insert and deleted nodes, and the Jaccard distance for substituting nodes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#aizynthfinder.analysis.ReactionTree" title="aizynthfinder.analysis.ReactionTree"><em>ReactionTree</em></a>) – the reaction tree to compare to</p></li>
<li><p><strong>content</strong> (<em>str</em>) – determine what part of the tree to include in the calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the distance between the routes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.in_stock">
<code class="sig-name descname"><span class="pre">in_stock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.in_stock" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if a node in the route is in stock</p>
<p>Note that is a property set on creation and as such is not updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule"><em>UniqueMolecule</em></a><em>, </em><a class="reference internal" href="#aizynthfinder.chem.FixedRetroReaction" title="aizynthfinder.chem.FixedRetroReaction"><em>FixedRetroReaction</em></a><em>]</em>) – the query node</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if the molecule is in stock</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.leafs">
<code class="sig-name descname"><span class="pre">leafs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.leafs" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the molecules nodes of the reaction tree that has no predecessors,
i.e. molecules that has not been broken down</p>
<dl class="field-list simple">
<dt class="field-odd">Yield</dt>
<dd class="field-odd"><p>the next leaf molecule in the tree</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Iterable[<a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule">UniqueMolecule</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.molecules">
<code class="sig-name descname"><span class="pre">molecules</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the molecule nodes of the reaction tree</p>
<dl class="field-list simple">
<dt class="field-odd">Yield</dt>
<dd class="field-odd"><p>the next molecule in the tree</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Iterable[<a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule">UniqueMolecule</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.reactions">
<code class="sig-name descname"><span class="pre">reactions</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the reaction nodes of the reaction tree</p>
<dl class="field-list simple">
<dt class="field-odd">Yield</dt>
<dd class="field-odd"><p>the next reaction in the tree</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Iterable[<a class="reference internal" href="#aizynthfinder.chem.FixedRetroReaction" title="aizynthfinder.chem.FixedRetroReaction">FixedRetroReaction</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.to_dict">
<code class="sig-name descname"><span class="pre">to_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reaction tree as a dictionary in a pre-defined format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reaction tree</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>StrDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.to_image">
<code class="sig-name descname"><span class="pre">to_image</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_stock_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pictoral representation of the route</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if image could not be produced</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>in_stock_colors</strong> (<em>FrameColors</em>) – the colors around molecules, defaults to {True: “green”, False: “orange”}</p></li>
<li><p><strong>show_all</strong> (<em>bool</em>) – if True, also show nodes that are marked as hidden</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the image of the route</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>PilImage</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.ReactionTree.to_json">
<code class="sig-name descname"><span class="pre">to_json</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.ReactionTree.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reaction tree as a JSON string in a pre-defined format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reaction tree</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.analysis.RouteCollection">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.analysis.</span></code><code class="sig-name descname"><span class="pre">RouteCollection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_trees</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Holds a collections of reaction routes.</p>
<p>If can be the top scored nodes, their scores and
the reaction trees created from them.
It can also be a cluster of such routes.</p>
<p>The class has the functionality to compute collective results
for the different routes such as images.</p>
<p>Properties of individual route can be obtained with simple indexing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">route0</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_scores</strong> – all the computed scores for the routes</p></li>
<li><p><strong>nodes</strong> – the top-ranked nodes</p></li>
<li><p><strong>scores</strong> – initial scores of top-ranked nodes</p></li>
<li><p><strong>reaction_trees</strong> – the reaction trees created from the top-ranked nodes</p></li>
<li><p><strong>clusters</strong> – the created clusters from the collection</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>reaction_trees</strong> – the trees to base the collection on</p>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.from_analysis">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_analysis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.from_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a collection from a tree analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis</strong> (<a class="reference internal" href="#aizynthfinder.analysis.TreeAnalysis" title="aizynthfinder.analysis.TreeAnalysis"><em>aizynthfinder.analysis.TreeAnalysis</em></a>) – the tree analysis to use</p></li>
<li><p><strong>min_nodes</strong> (<em>int</em>) – the minimum number of top-ranked nodes to consider</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created collection</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.analysis.RouteCollection" title="aizynthfinder.analysis.RouteCollection">RouteCollection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.dicts">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dicts</span></code><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of dictionary representation of the routes</p>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.images">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">images</span></code><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of pictoral representation of the routes</p>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.jsons">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">jsons</span></code><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.jsons" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of JSON string representation of the routes</p>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.cluster">
<code class="sig-name descname"><span class="pre">cluster</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster the route collection into a number of clusters.</p>
<p>Additional arguments to the distance or clustering algorithm
can be passed in as key-word arguments.</p>
<p>If the number of reaction trees are less than 3, no clustering will be performed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> (<em>int</em>) – the desired number of clusters, if less than 2 triggers optimization</p></li>
<li><p><strong>max_clusters</strong> (<em>int</em>) – the maximum number of clusters to consider</p></li>
<li><p><strong>timeout</strong> (<em>int</em>) – if given, return no clusters if distance calculation is taking longer time</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the cluster labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.combined_reaction_trees">
<code class="sig-name descname"><span class="pre">combined_reaction_trees</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recreate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.combined_reaction_trees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an object that combines all the reaction tree into a single reaction tree graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>recreate</strong> (<em>bool</em>) – if False will return a cached object if available, defaults to False</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the combined trees</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="aizynthfinder.utils.html#aizynthfinder.utils.analysis_helpers.CombinedReactionTrees" title="aizynthfinder.utils.analysis_helpers.CombinedReactionTrees">aizynthfinder.utils.analysis_helpers.CombinedReactionTrees</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.compute_scores">
<code class="sig-name descname"><span class="pre">compute_scores</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">scorers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.compute_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute new scores for all routes in this collection.
They can then be accessed with the <code class="docutils literal notranslate"><span class="pre">all_scores</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scorers</strong> (<a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.scoring.Scorer" title="aizynthfinder.context.scoring.Scorer"><em>Scorer</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.dict_with_scores">
<code class="sig-name descname"><span class="pre">dict_with_scores</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.dict_with_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the routes as dictionaries with all scores added
to the root (target) node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the routes as dictionaries</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Sequence[StrDict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.distance_matrix">
<code class="sig-name descname"><span class="pre">distance_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recreate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance matrix between each pair of reaction trees</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>content</strong> (<em>str</em>) – determine what part of the tree to include in the calculation</p></li>
<li><p><strong>recreate</strong> (<em>bool</em>) – if False, use a cached one if available</p></li>
<li><p><strong>timeout</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – if given, raises an exception if timeout is taking longer time</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the square distance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.make_dicts">
<code class="sig-name descname"><span class="pre">make_dicts</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.make_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all reaction trees to dictionaries</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Sequence[StrDict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.make_images">
<code class="sig-name descname"><span class="pre">make_images</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.make_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all reaction trees to images</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Sequence[Optional[PilImage]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.make_jsons">
<code class="sig-name descname"><span class="pre">make_jsons</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.make_jsons" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all reaction trees to JSON strings</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Sequence[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.analysis.RouteCollection.rescore">
<code class="sig-name descname"><span class="pre">rescore</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scorer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.analysis.RouteCollection.rescore" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescore the routes in the collection, and thereby re-order them.</p>
<p>This will replace the <code class="docutils literal notranslate"><span class="pre">scores</span></code> attribute, and update the <code class="docutils literal notranslate"><span class="pre">all_scores</span></code>
attribute with another entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scorer</strong> (<a class="reference internal" href="aizynthfinder.context.html#aizynthfinder.context.scoring.Scorer" title="aizynthfinder.context.scoring.Scorer"><em>Scorer</em></a>) – the scorer to use</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aizynthfinder.chem">
<span id="aizynthfinder-chem-module"></span><h2>aizynthfinder.chem module<a class="headerlink" href="#module-aizynthfinder.chem" title="Permalink to this headline">¶</a></h2>
<p>Module containing classes to deal with Molecules and Reactions - mostly wrappers around rdkit routines.</p>
<dl class="py exception">
<dt id="aizynthfinder.chem.MoleculeException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">MoleculeException</span></code><a class="headerlink" href="#aizynthfinder.chem.MoleculeException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception that is raised by the Molecule class</p>
</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.Molecule">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">Molecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rd_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A base class for molecules. Encapsulate an RDKit mol object and
functions that can be applied to such a molecule.</p>
<p>The objects of this class is hashable by the inchi key and hence
comparable with the equality operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rd_mol</strong> – the RDkit mol object that is encapsulated</p></li>
<li><p><strong>smiles</strong> – the SMILES representation of the molecule</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rd_mol</strong> – a RDKit mol object to encapsulate, defaults to None</p></li>
<li><p><strong>smiles</strong> – a SMILES to convert to a molecule object, defaults to None</p></li>
<li><p><strong>sanitize</strong> – if True, the molecule will be immediately sanitized, defaults to False</p></li>
</ul>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.chem.MoleculeException" title="aizynthfinder.chem.MoleculeException"><strong>MoleculeException</strong></a> – if neither rd_mol or smiles is given, or if the molecule could not be sanitized</p>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.inchi">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">inchi</span></code><a class="headerlink" href="#aizynthfinder.chem.Molecule.inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>The inchi representation of the molecule
Created by lazy evaluation. Will cause the molecule to be sanitized.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the inchi</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.inchi_key">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">inchi_key</span></code><a class="headerlink" href="#aizynthfinder.chem.Molecule.inchi_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inchi key representation of the molecule
Created by lazy evaluation. Will cause the molecule to be sanitized.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the inchi key</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.basic_compare">
<code class="sig-name descname"><span class="pre">basic_compare</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.basic_compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare this molecule to another but only to
the basic part of the inchi key, thereby ignoring stereochemistry etc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#aizynthfinder.chem.Molecule" title="aizynthfinder.chem.Molecule"><em>Molecule</em></a>) – the molecule to compare to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if chemical formula and connectivity is the same</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.fingerprint">
<code class="sig-name descname"><span class="pre">fingerprint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.fingerprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Morgan fingerprint of the molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>int</em>) – the radius of the fingerprint</p></li>
<li><p><strong>nbits</strong> (<em>int</em>) – the length of the fingerprint</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the fingerprint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.has_atom_mapping">
<code class="sig-name descname"><span class="pre">has_atom_mapping</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.has_atom_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if a the molecule has atom mappings</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if at least one atom has a mapping</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.make_unique">
<code class="sig-name descname"><span class="pre">make_unique</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.make_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of the UniqueMolecule class that
is representing the same molecule but is not hashable or comparable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the unique molecule</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule">UniqueMolecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.remove_atom_mapping">
<code class="sig-name descname"><span class="pre">remove_atom_mapping</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.remove_atom_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all mappings of the atoms and update the smiles</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Molecule.sanitize">
<code class="sig-name descname"><span class="pre">sanitize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raise_exception</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Molecule.sanitize" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanitizes the molecule if it has not been done before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raise_exception</strong> (<em>bool</em>) – if True will raise exception on failed sanitation</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#aizynthfinder.chem.MoleculeException" title="aizynthfinder.chem.MoleculeException"><strong>MoleculeException</strong></a> – if the molecule could not be sanitized</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.TreeMolecule">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">TreeMolecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rd_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.TreeMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aizynthfinder.chem.Molecule" title="aizynthfinder.chem.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">aizynthfinder.chem.Molecule</span></code></a></p>
<p>A special molecule that keeps a reference to a parent molecule.</p>
<p>If the class is instantiated without specifying the <cite>transform</cite> argument,
it is computed by increasing the value of the <cite>parent.transform</cite> variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent</strong> – parent molecule</p></li>
<li><p><strong>transform</strong> – a numerical number corresponding to the depth in the tree</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>parent</strong> – a TreeMolecule object that is the parent</p></li>
<li><p><strong>transform</strong> – the transform value, defaults to None</p></li>
<li><p><strong>rd_mol</strong> – a RDKit mol object to encapsulate, defaults to None</p></li>
<li><p><strong>smiles</strong> – a SMILES to convert to a molecule object, defaults to None</p></li>
<li><p><strong>sanitize</strong> – if True, the molecule will be immediately sanitized, defaults to False</p></li>
</ul>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.chem.MoleculeException" title="aizynthfinder.chem.MoleculeException"><strong>MoleculeException</strong></a> – if neither rd_mol or smiles is given, or if the molecule could not be sanitized</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.UniqueMolecule">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">UniqueMolecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rd_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.UniqueMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aizynthfinder.chem.Molecule" title="aizynthfinder.chem.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">aizynthfinder.chem.Molecule</span></code></a></p>
<p>A special molecule with the hash set to the id of the object.
Therefore no two instances of this class will be comparable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rd_mol</strong> – a RDKit mol object to encapsulate, defaults to None</p></li>
<li><p><strong>smiles</strong> – a SMILES to convert to a molecule object, defaults to None</p></li>
<li><p><strong>sanitize</strong> – if True, the molecule will be immediately sanitized, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#aizynthfinder.chem.MoleculeException" title="aizynthfinder.chem.MoleculeException"><strong>MoleculeException</strong></a> – if neither rd_mol or smiles is given, or if the molecule could not be sanitized</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="aizynthfinder.chem.none_molecule">
<code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">none_molecule</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.none_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an empty molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.chem.UniqueMolecule" title="aizynthfinder.chem.UniqueMolecule">aizynthfinder.chem.UniqueMolecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.Reaction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">Reaction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">aizynthfinder.chem._ExpandableReactionInterfaceMixin</span></code></p>
<p>An abstraction of a reaction. Encapsulate an RDKit reaction object and
functions that can be applied to such a reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> – the Molecule objects that this reaction are applied to</p></li>
<li><p><strong>smarts</strong> – the SMARTS representation of the reaction</p></li>
<li><p><strong>index</strong> – a unique index of this reaction,
to count for the fact that a reaction can produce more than one outcome</p></li>
<li><p><strong>metadata</strong> – meta data associated with the reaction</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mols</strong> – the molecules</p></li>
<li><p><strong>smarts</strong> – the SMARTS fragment</p></li>
<li><p><strong>index</strong> – the index, defaults to 0</p></li>
<li><p><strong>metadata</strong> – some meta data</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.chem.Reaction.products">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">products</span></code><a class="headerlink" href="#aizynthfinder.chem.Reaction.products" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the product molecules.
Apply the reaction if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the products of the reaction</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.Reaction.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.Reaction.apply" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Tuple[<a class="reference internal" href="#aizynthfinder.chem.Molecule" title="aizynthfinder.chem.Molecule">Molecule</a>, ..], ..]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.RetroReaction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">RetroReaction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.RetroReaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">aizynthfinder.chem._ExpandableReactionInterfaceMixin</span></code></p>
<p>A retrosynthesis reaction. Only a single molecule is the reactant.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – the TreeMolecule object that this reaction is applied to</p></li>
<li><p><strong>smarts</strong> – the SMARTS representation of the reaction</p></li>
<li><p><strong>index</strong> – a unique index of this reaction,
to count for the fact that a reaction can produce more than one outcome</p></li>
<li><p><strong>metadata</strong> – meta data associated with the reaction</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mol</strong> – the molecule</p></li>
<li><p><strong>smarts</strong> – the SMARTS fragment</p></li>
<li><p><strong>index</strong> – the index, defaults to 0</p></li>
<li><p><strong>metadata</strong> – some meta data</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.chem.RetroReaction.from_reaction_smiles">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_reaction_smiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smarts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.RetroReaction.from_reaction_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a retro reaction by parsing a reaction smiles.</p>
<p>Note that applying reaction does not necessarily give the
same outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – the reaction smiles</p></li>
<li><p><strong>smarts</strong> (<em>str</em>) – the SMARTS of the reaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed reaction object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.chem.RetroReaction" title="aizynthfinder.chem.RetroReaction">RetroReaction</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.RetroReaction.reactants">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">reactants</span></code><a class="headerlink" href="#aizynthfinder.chem.RetroReaction.reactants" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reactant molecules.
Apply the reaction if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the products of the reaction</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.RetroReaction.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.RetroReaction.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a reactions smarts to a molecule and return the products (reactants for retro templates)</p>
<p>Will try to sanitize the reactants, and if that fails it will not return that molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the products of the reaction</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[Tuple[<a class="reference internal" href="#aizynthfinder.chem.TreeMolecule" title="aizynthfinder.chem.TreeMolecule">TreeMolecule</a>, ..], ..]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aizynthfinder.chem.RetroReaction.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.RetroReaction.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow copy of this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – new index, defaults to None</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the copy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aizynthfinder.chem.RetroReaction" title="aizynthfinder.chem.RetroReaction">RetroReaction</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aizynthfinder.chem.FixedRetroReaction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">FixedRetroReaction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.FixedRetroReaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">aizynthfinder.chem._ReactionInterfaceMixin</span></code></p>
<p>A retrosynthesis reaction that has the same interface as <cite>RetroReaction</cite>
but it is fixed so it does not support SMARTS application.</p>
<p>The reactants are set by using the <cite>reactants</cite> property.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – the UniqueMolecule object that this reaction is applied to</p></li>
<li><p><strong>smiles</strong> – the SMILES representation of the RDKit reaction</p></li>
<li><p><strong>metadata</strong> – meta data associated with the reaction</p></li>
<li><p><a class="reference internal" href="#aizynthfinder.chem.RetroReaction.reactants" title="aizynthfinder.chem.RetroReaction.reactants"><strong>reactants</strong></a> – the reactants of this reaction</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mol</strong> – the molecule</p></li>
<li><p><strong>smiles</strong> – the SMILES of the reaction</p></li>
<li><p><strong>metadata</strong> – some meta data</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="aizynthfinder.chem.FixedRetroReaction.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.FixedRetroReaction.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow copy of this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the copy</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#aizynthfinder.chem.FixedRetroReaction" title="aizynthfinder.chem.FixedRetroReaction">FixedRetroReaction</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="aizynthfinder.chem.hash_reactions">
<code class="sig-prename descclassname"><span class="pre">aizynthfinder.chem.</span></code><code class="sig-name descname"><span class="pre">hash_reactions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aizynthfinder.chem.hash_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a hash for a list of reactions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reactions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><a class="reference internal" href="#aizynthfinder.chem.Reaction" title="aizynthfinder.chem.Reaction"><em>Reaction</em></a><em>]</em><em>, </em><em>List</em><em>[</em><a class="reference internal" href="#aizynthfinder.chem.RetroReaction" title="aizynthfinder.chem.RetroReaction"><em>RetroReaction</em></a><em>]</em><em>, </em><em>List</em><em>[</em><a class="reference internal" href="#aizynthfinder.chem.FixedRetroReaction" title="aizynthfinder.chem.FixedRetroReaction"><em>FixedRetroReaction</em></a><em>]</em><em>]</em>) – the reactions to hash</p></li>
<li><p><strong>sort</strong> (<em>bool</em>) – if True will sort all molecules, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the hash string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-aizynthfinder">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aizynthfinder" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Molecular AI group.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/aizynthfinder.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>